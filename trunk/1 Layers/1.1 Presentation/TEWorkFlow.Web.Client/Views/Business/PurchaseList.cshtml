@{
    ViewBag.Title = "商品采购管理";
    Layout = "~/Views/Shared/_ListLayout.cshtml";
}
@section toolbar{
    <table style="width: 100%;">
        <tr>
            <td style="width: 100%;">
                <a class="mini-button" iconcls="icon-add" onclick="editRow('')" plain="true">增加</a>
                <a class="mini-button" iconcls="icon-remove" onclick="remove()" plain="true">删除</a>
                <a class="mini-button" iconcls="icon-date-magnify" onclick="showSearchWindow()" plain="true">
                    筛选</a> <span class="separator"></span>
            </td>
            <td style="white-space: nowrap;">
                <input id="bName" class="mini-textbox" emptytext="请输入名称" style="width: 150px;" onenter="onKeyEnter" />
                <a class="mini-button" onclick="search()">查询</a>
            </td>
        </tr>
    </table>
}
@section script
{
    <script type="text/javascript">
        mini.parse();
        function showSearchWindow() {
            var win = mini.get("searchWindow");
            win.show();
        }
        function advSearch() {
            var frm = new mini.Form("frmAdv");
            grid.load(frm.getData(true));
            var win = mini.get("searchWindow");
            win.hide();
        }
        function search() {
            grid.load({
                "bName": mini.get("#bName").value
            });
        }
        function editRow(id) {
            mini.open({
                url: "/Business/PurchaseEdit/" + id,
                title: "采购管理",
                iconCls: "icon-cart",
                allowResize: false,
                width: 710,
                height: 320,
                onload: function () {
                },
                ondestroy: function (action) {

                    grid.reload();
                }
            });
        }
        function deleteItem(id) {
            $.ajax({
                url: "/Business/BranchDelete",
                data: { ids: id },
                success: function (text) {
                    grid.reload();
                },
                error: function () {
                }
            });
        }
    </script>
}

<div id="datagrid1" class="mini-datagrid" url="/Business/SearchPurchaseList"
    style="width: 100%; height: 100%;" idfield="id" allowresize="false" sizelist="[20,30,50,100]"
    pagesize="20" multiselect="true">
    <div property="columns">
        <div type="indexcolumn" width="30">
        </div>
        <div type="checkcolumn" width="30">
        </div>
        <div field="SupCode" headeralign="center" align="center" width="60">供货商编码</div>
        <div field="EnCode" headeralign="center" align="center" width="60">企业编码</div>
        <div field="PcForm" headeralign="center" align="center" width="60">采购形式</div>
        <div field="dCode" headeralign="center" align="center" width="60">部门编码</div>
        <div field="bCode" headeralign="center" align="center" width="60">门店编码</div>
        <div field="PcType" headeralign="center" align="center" width="60">采购类型</div>
        <div field="PcMode" headeralign="center" align="center" width="60">采购方式</div>
        <div field="WhCode" headeralign="center" align="center" width="60">仓库编码</div>
        <div field="PurchaseDate" headeralign="center" align="center" width="60">采购日期</div>
        <div field="ExpectArriveDate" headeralign="center" align="center" width="60">预计到货日期</div>
        <div name="action" width="120" headeralign="center" align="center" renderer="onActionRenderer" cellstyle="padding:0;">管理</div>
    </div>
</div>

<div id="searchWindow" class="mini-window" title="高级筛选" style="width: 450px; height: 300px;"
    iconcls="icon-date-magnify" showmaxbutton="true" showtoolbar="true" showfooter="true"
    showmodal="false" allowresize="false" allowdrag="true">
    <div property="footer" style="text-align: right; padding: 5px; padding-right: 15px;">
        <a class="mini-button" iconcls="icon-zoom" onclick="advSearch()" style='vertical-align: middle;'>
            筛选</a>
    </div>
    <form id="frmAdv">

    </form>
</div>
